(function(){var e;e=Array.prototype.concat,LazyLoad.js(e.apply(scripts.jsonschemaeditor)),$(document).on("pagebeforecreate","#edit-plugin-page",function(e){var n,i;if(null==pimatic.pages.editPlugin){n=function(){function e(){this.pageTitle=ko.computed(function(){return __("Plugin Config")}),this.pluginName.subscribe(function(e){return function(n){return null!=n&&"string"==typeof n&&n.length>0?pimatic.client.rest.getPluginConfigSchema({pluginName:"pimatic-"+n}).done(function(i){var t,a,o;if(null!=i.success)return a=i.configSchema,delete a.properties.active,delete a.properties.plugin,o=jsonschemaeditor.unwrap(e.pluginConfig()),t=jsonschemaeditor.wrap(a,o),e.configSchema(null),e.pluginConfig(t()),jsonschemaeditor.enhanceSchema(a,null),a.name=n,e.configSchema(a)}):e.configSchema(null)}}(this))}return e.prototype.action=ko.observable("add"),e.prototype.pluginName=ko.observable(""),e.prototype.pluginConfig=ko.observable({}),e.prototype.configSchema=ko.observable(null),e.prototype.afterRenderItem=function(e,n){var i;return i=$("#sortable-handle-template").text(),$(e).find("a").before($(i))},e.prototype.resetFields=function(){return this.pluginName(""),this.pluginConfig({}),this.configSchema(null)},e.prototype.onSubmit=function(){var e,n,i;if(i=this.pluginName(),n=jsonschemaeditor.unwrap(this.pluginConfig()),e=[],jsonschemaeditor.validate(this.configSchema(),n,e),!(e.length>0))return n.plugin=i,n.active=!0,pimatic.client.rest.updatePluginConfig({pluginName:i,config:n}).done(function(e){var n;return(n=pimatic.pages.plugins).refresh(),n.restartRequired(!0),e.success?$.mobile.changePage("#plugins-page",{transition:"slide",reverse:!0}):alert(e.error)}).fail(ajaxAlertFail),!1;alert(e.join("\n"))},e}();try{pimatic.pages.editPlugin=new n}catch(e){i=e,TraceKit.report(i)}}}),$(document).on("pagebeforeshow","#edit-plugin-page",function(e){}),$(document).on("pagecreate","#edit-plugin-page",function(e){var n;try{return ko.applyBindings(pimatic.pages.editPlugin,$("#edit-plugin-page")[0])}catch(e){return n=e,TraceKit.report(n)}}),$(document).on("pagebeforeshow","#edit-plugin-page",function(e){var n,i;if(n=pimatic.pages.editPlugin,i=jQuery.mobile.pageParams,jQuery.mobile.pageParams={},null!=i)return n.pluginName(null),n.configSchema(null),pimatic.client.rest.getPluginConfig({pluginName:i.pluginName}).always(function(e){var t;if(null!=e.success)return t=e.config||{},n.pluginConfig(t),n.pluginName(i.pluginName)})})}).call(this);