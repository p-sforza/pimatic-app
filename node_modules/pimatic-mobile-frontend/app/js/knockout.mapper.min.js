!function(r){"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?r(require("knockout"),exports):"function"==typeof define&&define.amd?define(["knockout","exports"],r):r(ko,ko.mapper={})}(function(r,e){function n(e,n,o){if("function"==typeof n){for(var t=n(o),a=0;a<e.length;a++)if((u=n(e[a]))==t)return e[a]}else for(var t=o[n],a=0;a<e.length;a++){var u=r.utils.unwrapObservable(e[a][n]);if(u==t)return e[a]}return null}function o(r){return null==r?null:r instanceof Array?"array":r instanceof Date?"date":r instanceof RegExp?"regex":typeof r}e.fromJS=function(r,n,t,a){var u="auto";return n&&n.$fromJS&&(n=n.$fromJS),n?n.$handler?u=n.$handler.fromJS||n.$handler:"string"==o(n)&&(u=n):n={},"function"==typeof u?u(r,n,t,a):e.handlers[u].fromJS(r,n,t,a)},e.toJS=function(r,n){var t="auto";return n&&n.$toJS&&(n=n.$toJS),n?n.$handler?t=n.$handler.toJS||n.$handler:"string"==o(n)&&(t=n):n={},"function"==typeof t?t(r,n):e.handlers[t].toJS(r,n)},e.fromJSON=function(n,o,t,a){return e.fromJS(r.utils.parseJson(n),o,t,a)},e.toJSON=function(n,o){return r.utils.stringifyJson(e.toJS(n,o))},e.resolveFromJSHandler=function(r,e,n,t){var a=o(r);return"array"==a?"array":"object"==a?"object":"value"},e.resolveToJSHandler=function(e,n){var t=o(r.utils.unwrapObservable(e));return"array"==t?"array":"object"==t?"object":"value"},e.handlers={},e.handlers.auto={fromJS:function(r,n,o,t){var a=e.resolveFromJSHandler(r,n,o,t);return e.handlers[a].fromJS(r,n,o,t)},toJS:function(r,n){var o=e.resolveToJSHandler(r,n);return e.handlers[o].toJS(r,n)}},e.ignore={},e.handlers.ignore={fromJS:function(r,n,o,t){return e.ignore},toJS:function(r,n){return e.ignore}},e.handlers.copy={fromJS:function(r,e,n,o){return r},toJS:function(r,e){return r}},e.handlers.value={fromJS:function(e,n,o,t){return r.isObservable(o)&&(t||void 0==t||null==t)?(o(e),o):t?r.observable(e):e},toJS:function(e,n){return r.utils.unwrapObservable(e)}},e.handlers.array={fromJS:function(o,t,a,u){var l,f=r.utils.unwrapObservable(a),i=t.$key&&f,s=t.$itemOptions;"function"==typeof s&&(s=s());var v=!1;if(t.$merge){v=!0,l=f||[];for(c=0;c<o.length;c++){J=i?n(f,t.$key,o[c]):null;(S=e.fromJS(o[c],s,J))===e.ignore||J||l.push(S)}}else{l=[],f&&f.length!==o.length&&(v=!0);for(var c=0;c<o.length;c++){var J=i?n(f,t.$key,o[c]):null,S=e.fromJS(o[c],s,J);v||(v=!(f&&c<f.length)||f[c]!==S),S!==e.ignore&&l.push(S)}}return u||void 0==u||null==u?r.isObservable(a)?(v&&a(l),a):r.observableArray(l):l},toJS:function(n,o){for(var t=r.utils.unwrapObservable(n),a=[],u=0;u<t.length;u++){var l=o.$itemOptions;"function"==typeof l&&(l=l(n,o));var f=e.toJS(t[u],l);f!==e.ignore&&a.push(f)}return a}},e.handlers.object={fromJS:function(n,o,t,a){var u=r.utils.unwrapObservable(t);u||(u=o.$type?new o.$type:{});for(var l in n){var f=e.fromJS(n[l],o[l]||o.$default,u[l],!0);f!==e.ignore&&u[l]!=f&&(u[l]=f)}return r.isObservable(t)&&(a||void 0==a||null==a)?(t(u),t):a?r.observable(u):u},toJS:function(n,o){var t=r.utils.unwrapObservable(n),a={};for(var u in t){var l=e.toJS(t[u],o[u]||o.$default);l!==e.ignore&&(a[u]=l)}return a}}});