(function(){var t,o=function(t,o){return function(){return t.apply(o,arguments)}};t=pimatic.tryCatch,$(document).on("pagebeforecreate","#groups-page",t(function(e){var r;return r=function(){function e(){this.onEditGroupClicked=o(this.onEditGroupClicked,this),this.onGroupsSorted=o(this.onGroupsSorted,this),this.groups=pimatic.groups,this.hasPermission=pimatic.hasPermission,this.groupsListViewRefresh=ko.computed(t(function(t){return function(){return t.groups(),t.isSortingGroups(),t.enabledEditing(),pimatic.try(function(){return $("#groups").listview("refresh").addClass("dark-background")})}}(this))).extend({rateLimit:{timeout:1,method:"notifyWhenChangesStop"}}),this.lockButton=ko.computed(t(function(t){return function(){var o;return o=t.enabledEditing(),{icon:o?"check":"gear"}}}(this)))}return e.prototype.enabledEditing=ko.observable(!0),e.prototype.isSortingGroups=ko.observable(!1),e.prototype.afterRenderGroup=function(t,o){var e;return e=$("#sortable-handle-template").text(),$(t).find("a").before($(e))},e.prototype.toggleEditing=function(){return this.enabledEditing(!this.enabledEditing())},e.prototype.onGroupsSorted=function(t,o,e){var r,i,n,a,u;for(i=[],null==o&&i.push(t.id),n=0,a=(u=this.groups()).length;n<a;n++)(r=u[n])!==t&&(i.push(r.id),null!=o&&r===o&&i.push(t.id));return pimatic.client.rest.updateGroupOrder({groupOrder:i}).done(ajaxShowToast).fail(ajaxAlertFail)},e.prototype.onDropGroupOnTrash=function(t){if(confirm(__("Do you really want to delete the %s group?",t.name())))return function(){return pimatic.loading("deletegroup","show",{text:__("Saving")}),pimatic.client.rest.removeGroup({groupId:t.id}).always(function(){return pimatic.loading("deletegroup","hide")}).done(ajaxShowToast).fail(ajaxAlertFail)}()},e.prototype.onAddGroupClicked=function(){return jQuery.mobile.pageParams={action:"add"},!0},e.prototype.onEditGroupClicked=function(t){return this.hasPermission("groups","write")||pimatic.isDemo()?(jQuery.mobile.pageParams={action:"update",group:t},!0):(pimatic.showToast(__("Sorry, you have no permissions to edit this group.")),!1)},e}(),pimatic.pages.groups=new r})),$(document).on("pagecreate","#groups-page",t(function(t){var o,e,r;e=pimatic.pages.groups;try{ko.applyBindings(e,$("#groups-page")[0])}catch(t){o=t,TraceKit.report(o),null!=(r=pimatic.storage)&&r.removeAll(),window.location.reload()}$("#groups .handle").disableSelection()})),$(document).on("pagebeforeshow","#groups-page",t(function(t){return pimatic.try(function(){return $("#groups").listview("refresh").addClass("dark-background")})}))}).call(this);