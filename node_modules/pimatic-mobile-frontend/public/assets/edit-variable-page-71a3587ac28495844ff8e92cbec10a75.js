(function(){$(document).on("pagebeforecreate","#edit-variable-page",function(e){var a,t;if(null==pimatic.pages.editVariable){a=function(){function e(){this.pageTitle=ko.computed(function(e){return function(){return"add"===e.action()?__("Add new variable"):__("Edit variable")}}(this)),this.valueLabelText=ko.computed(function(e){return function(){return"value"===e.variableType()?__("Value"):__("Expr.")}}(this))}return e.prototype.autocompleteAjax=null,e.prototype.autocompleEnabled=!1,e.prototype.action=ko.observable("add"),e.prototype.variableName=ko.observable(""),e.prototype.variableValue=ko.observable(""),e.prototype.variableType=ko.observable("value"),e.prototype.variableUnit=ko.observable(""),e.prototype.resetFields=function(){return this.variableName(""),this.variableValue(""),this.variableType("value"),this.variableUnit("")},e.prototype.onSubmit=function(){var e;{if(pimatic.isValidVariableName(this.variableName()))return e={name:this.variableName(),type:this.variableType(),valueOrExpression:this.variableValue(),unit:this.variableUnit()},function(){switch(this.action()){case"add":return pimatic.client.rest.addVariable(e);case"update":return pimatic.client.rest.updateVariable(e);default:throw new Error("Illegal variable action: "+action())}}.call(this).done(function(e){return e.success?$.mobile.changePage("#variables-page",{transition:"slide",reverse:!0}):alert(e.error)}).fail(ajaxAlertFail),!1;alert(__(pimatic.invalidVariableNameMessage))}},e.prototype.onRemove=function(){return confirm(__("Do you really want to delete the %s variable?",this.variableName()))&&pimatic.client.rest.removeVariable({name:this.variableName()}).done(function(e){return e.success?$.mobile.changePage("#variables-page",{transition:"slide",reverse:!0}):alert(e.error)}).fail(ajaxAlertFail),!1},e}();try{pimatic.pages.editVariable=new a}catch(e){t=e,TraceKit.report(t)}}}),$(document).on("pagecreate","#edit-variable-page",function(e){var a;try{return ko.applyBindings(pimatic.pages.editVariable,$("#edit-variable-page")[0])}catch(e){return a=e,TraceKit.report(a)}}),$(document).on("pagebeforeshow","#edit-variable-page",function(e){var a,t,i;a=pimatic.pages.editVariable,t=jQuery.mobile.pageParams,jQuery.mobile.pageParams={},"update"===(null!=t?t.action:void 0)?(i=t.variable,a.action("update"),a.variableName(i.name),a.variableValue("value"===i.type()?i.value():i.exprInputStr()),a.variableType(i.type()),a.variableUnit(i.unit())):(a.resetFields(),a.action("add"))})}).call(this);