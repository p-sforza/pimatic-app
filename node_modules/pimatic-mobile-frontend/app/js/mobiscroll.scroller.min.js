!function(e,t,l,a){var s,i=e.mobiscroll,n=i.classes,d=i.instances,o=i.util,r=o.jsPrefix,u=o.has3d,w=o.hasFlex,h=o.getCoord,c=o.constrain,p=o.testTouch;n.Scroller=function(t,i,v){function f(t){!p(t,this)||s||H||F||W(this)||(t.preventDefault(),t.stopPropagation(),s=!0,E="clickpick"!=z.mode,M(Z=e(".dw-ul",this)),N=se[$]!==a,J=N?q(Z):ie[$],O=h(t,"Y"),Q=new Date,G=O,T(Z,$,J,.001),E&&Z.closest(".dwwl").addClass("dwa"),"mousedown"===t.type&&e(l).on("mousemove",m).on("mouseup",y))}function m(e){s&&E&&(e.preventDefault(),e.stopPropagation(),G=h(e,"Y"),(Math.abs(G-O)>3||N)&&(T(Z,$,c(J+(O-G)/Y,K-1,X+1)),N=!0))}function y(t){if(s){var a,i,n,d=new Date-Q,o=c(J+(O-G)/Y,K-1,X+1),r=Z.offset().top;if(t.stopPropagation(),u&&d<300?(i=(a=(G-O)/d)*a/z.speedUnit,G-O<0&&(i=-i)):i=G-O,n=Math.round(J-i/Y),!N){var w=Math.floor((G-r)/Y),h=e(e(".dw-li",Z)[w]),p=h.hasClass("dw-v"),v=E;!1!==B("onValueTap",[h])&&p?n=w:v=!0,v&&p&&(h.addClass("dw-hl"),setTimeout(function(){h.removeClass("dw-hl")},100))}E&&L(Z,n,0,!0,Math.round(o)),"mouseup"===t.type&&e(l).off("mousemove",m).off("mouseup",y),s=!1}}function _(t){F=e(this),p(t,this)&&C(t,F.closest(".dwwl"),F.hasClass("dwwbp")?S:R),"mousedown"===t.type&&e(l).on("mouseup",g)}function g(t){F=null,H&&(clearInterval(te),H=!1),"mouseup"===t.type&&e(l).off("mouseup",g)}function x(t){38==t.keyCode?C(t,e(this),R):40==t.keyCode&&C(t,e(this),S)}function V(){H&&(clearInterval(te),H=!1)}function b(t){if(!W(this)){t.preventDefault();var l=(t=t.originalEvent||t).wheelDelta?t.wheelDelta/120:t.detail?-t.detail/3:0,a=e(".dw-ul",this);M(a),L(a,Math.round(ie[$]-l),l<0?1:2)}}function C(e,t,l){if(e.stopPropagation(),e.preventDefault(),!H&&!W(t)&&!t.hasClass("dwa")){H=!0;var a=t.find(".dw-ul");M(a),clearInterval(te),te=setInterval(function(){l(a)},z.delay),l(a)}}function W(t){if(e.isArray(z.readonly)){var l=e(".dwwl",j).index(t);return z.readonly[l]}return z.readonly}function A(t){var l='<div class="dw-bf">',a=de[t],s=1,i=a.labels||[],n=a.values,d=a.keys||n;return e.each(n,function(e,t){s%20==0&&(l+='</div><div class="dw-bf">'),l+='<div role="option" aria-selected="false" class="dw-li dw-v" data-val="'+d[e]+'"'+(i[e]?' aria-label="'+i[e]+'"':"")+' style="height:'+Y+"px;line-height:"+Y+'px;"><div class="dw-i"'+(ee>1?' style="line-height:'+Math.round(Y/ee)+"px;font-size:"+Math.round(Y/ee*.8)+'px;"':"")+">"+t+"</div></div>",s++}),l+="</div>"}function M(t){var l=t.closest(".dwwl").hasClass("dwwms");K=e(".dw-li",t).index(e(l?".dw-li":".dw-v",t).eq(0)),X=Math.max(K,e(".dw-li",t).index(e(l?".dw-li":".dw-v",t).eq(-1))-(l?z.rows-1:0)),$=e(".dw-ul",j).index(t)}function k(e){var l=z.headerText;return l?"function"==typeof l?l.call(t,e):l.replace(/\{value\}/i,e):""}function q(e){return Math.round(-o.getPosition(e,!0)/Y)}function D(e,t){clearTimeout(se[t]),delete se[t],e.closest(".dwwl").removeClass("dwa")}function T(e,t,l,a,s){var i=-l*Y,n=e[0].style;i==ne[t]&&se[t]||(ne[t]=i,u?(n[r+"Transition"]=o.prefix+"transform "+(a?a.toFixed(3):0)+"s ease-out",n[r+"Transform"]="translate3d(0,"+i+"px,0)"):n.top=i+"px",se[t]&&D(e,t),a&&s&&(e.closest(".dwwl").addClass("dwa"),se[t]=setTimeout(function(){D(e,t)},1e3*a)),ie[t]=l)}function P(t,l,a,s){var i=e('.dw-li[data-val="'+t+'"]',l),n=e(".dw-li",l),d=n.index(i),o=n.length;if(s)M(l);else if(!i.hasClass("dw-v")){for(var r=i,u=i,w=0,h=0;d-w>=0&&!r.hasClass("dw-v");)w++,r=n.eq(d-w);for(;d+h<o&&!u.hasClass("dw-v");)h++,u=n.eq(d+h);(h<w&&h&&2!==a||!w||d-w<0||1==a)&&u.hasClass("dw-v")?(i=u,d+=h):(i=r,d-=w)}return{cell:i,v:s?c(d,K,X):d,val:i.hasClass("dw-v")?i.attr("data-val"):null}}function I(t,l,s,i,n){!1!==B("validate",[j,l,t,i])&&(e(".dw-ul",j).each(function(s){var d=e(this),o=d.closest(".dwwl").hasClass("dwwms"),r=s==l||l===a,u=P(le._tempWheelArray[s],d,i,o),w=u.cell;w.hasClass("dw-sel")&&!r||(le._tempWheelArray[s]=u.val,o||(e(".dw-sel",d).removeAttr("aria-selected"),w.attr("aria-selected","true")),e(".dw-sel",d).removeClass("dw-sel"),w.addClass("dw-sel"),T(d,s,u.v,r?t:.1,!!r&&n))}),B("onValidated",[]),le._tempValue=z.formatResult(le._tempWheelArray),le.live&&(le._hasValue=s||le._hasValue,U(s,s,0,!0)),le._header.html(k(le._tempValue)),s&&B("onChange",[le._tempValue]))}function L(t,l,s,i,n){l=c(l,K,X);var d=e(".dw-li",t).eq(l),o=n===a?l:n,r=n!==a,u=$,w=Math.abs(l-o),h=i?l==o?.1:w*z.timeUnit*Math.max(.5,(100-w)/100):0;le._tempWheelArray[u]=d.attr("data-val"),T(t,u,l,h,r),setTimeout(function(){I(h,u,!0,s,r)},10)}function S(e){var t=ie[$]+1;L(e,t>X?K:t,1,!0)}function R(e){var t=ie[$]-1;L(e,t<K?X:t,2,!0)}function U(e,t,l,a,s){le._isVisible&&!a&&I(l),le._tempValue=z.formatResult(le._tempWheelArray),s||(le._wheelArray=le._tempWheelArray.slice(0),le._value=le._hasValue?le._tempValue:null),e&&(B("onValueFill",[le._hasValue?le._tempValue:"",t]),le._isInput&&ae.val(le._hasValue?le._tempValue:""),t&&(le._preventChange=!0,ae.change()))}var j,F,E,Y,z,B,H,N,O,Q,G,J,K,X,Z,$,ee,te,le=this,ae=e(t),se={},ie={},ne={},de=[];n.Widget.call(this,t,i,!0),le.setVal=le._setVal=function(l,s,i,n,d){le._hasValue=null!==l&&l!==a,le._tempWheelArray=e.isArray(l)?l.slice(0):z.parseValue.call(t,l,le)||[],U(s,i===a?s:i,d,!1,n)},le.getVal=le._getVal=function(e){var t=le._hasValue?le[e?"_tempValue":"_value"]:null;return o.isNumeric(t)?+t:t},le.setArrayVal=le.setVal,le.getArrayVal=function(e){return e?le._tempWheelArray:le._wheelArray},le.setValue=function(e,t,l,a,s){le.setVal(e,t,s,a,l)},le.getValue=le.getArrayVal,le.changeWheel=function(t,l,s){if(j){var i=0,n=t.length;e.each(z.wheels,function(d,o){if(e.each(o,function(d,o){if(e.inArray(i,t)>-1&&(de[i]=o,e(".dw-ul",j).eq(i).html(A(i)),!--n))return le.position(),I(l,a,s),!1;i++}),!n)return!1})}},le.getValidCell=P,le._generateContent=function(){var t,l="",s=0;return e.each(z.wheels,function(i,n){l+='<div class="mbsc-w-p dwc'+("scroller"!=z.mode?" dwpm":" dwsc")+(z.showLabel?"":" dwhl")+'"><div class="dwwc"'+(z.maxWidth?"":' style="max-width:600px;"')+">"+(w?"":'<table class="dw-tbl" cellpadding="0" cellspacing="0"><tr>'),e.each(n,function(e,i){de[s]=i,t=i.label!==a?i.label:e,l+="<"+(w?"div":"td")+' class="dwfl" style="'+(z.fixedWidth?"width:"+(z.fixedWidth[s]||z.fixedWidth)+"px;":(z.minWidth?"min-width:"+(z.minWidth[s]||z.minWidth)+"px;":"min-width:"+z.width+"px;")+(z.maxWidth?"max-width:"+(z.maxWidth[s]||z.maxWidth)+"px;":""))+'"><div class="dwwl dwwl'+s+(i.multiple?" dwwms":"")+'">'+("scroller"!=z.mode?'<div class="dwb-e dwwb dwwbp '+(z.btnPlusClass||"")+'" style="height:'+Y+"px;line-height:"+Y+'px;"><span>+</span></div><div class="dwb-e dwwb dwwbm '+(z.btnMinusClass||"")+'" style="height:'+Y+"px;line-height:"+Y+'px;"><span>&ndash;</span></div>':"")+'<div class="dwl">'+t+'</div><div tabindex="0" aria-live="off" aria-label="'+t+'" role="listbox" class="dwww"><div class="dww" style="height:'+z.rows*Y+'px;"><div class="dw-ul" style="margin-top:'+(i.multiple?0:z.rows/2*Y-Y/2)+'px;">',l+=A(s)+'</div></div><div class="dwwo"></div></div><div class="dwwol"'+(z.selectedLineHeight?' style="height:'+Y+"px;margin-top:-"+(Y/2+(z.selectedLineBorder||0))+'px;"':"")+"></div></div>"+(w?"</div>":"</td>"),s++}),l+=(w?"":"</tr></table>")+"</div></div>"}),l},le._attachEvents=function(e){e.on("DOMMouseScroll mousewheel",".dwwl",b).on("keydown",".dwwl",x).on("keyup",".dwwl",V).on("touchstart mousedown",".dwwl",f).on("touchmove",".dwwl",m).on("touchend",".dwwl",y).on("touchstart mousedown",".dwwb",_).on("touchend",".dwwb",g)},le._markupReady=function(){j=le._markup,I()},le._fillValue=function(){le._hasValue=!0,U(!0,!0,0,!0)},le._readValue=function(){var e=ae.val()||"";le._hasValue=""!==e,le._tempWheelArray=le._wheelArray?le._wheelArray.slice(0):z.parseValue(e,le)||[],U()},le._processSettings=function(){z=le.settings,B=le.trigger,Y=z.height,ee=z.multiline,le._isLiquid="liquid"===(z.layout||(/top|bottom/.test(z.display)&&1==z.wheels.length?"liquid":"")),ee>1&&(z.cssClass=(z.cssClass||"")+" dw-ml")},le._selectedValues={},v||(d[t.id]=le,le.init(i))},n.Scroller.prototype._class="scroller",n.Scroller.prototype._defaults=e.extend({},n.Widget.prototype._defaults,{minWidth:80,height:40,rows:3,multiline:1,delay:300,readonly:!1,showLabel:!0,wheels:[],mode:"scroller",preset:"",speedUnit:.0012,timeUnit:.08,formatResult:function(e){return e.join(" ")},parseValue:function(t,l){var s,i=[],n=[],d=0;return null!==t&&t!==a&&(i=(t+"").split(" ")),e.each(l.settings.wheels,function(t,l){e.each(l,function(t,l){s=l.keys||l.values,-1!==e.inArray(i[d],s)?n.push(i[d]):n.push(s[0]),d++})}),n}})}(jQuery,window,document);